// Core9 - Module: module-platform-users
angular.module("core9Dashboard.users",["core9Dashboard.users.config","templates-module-platform-users"]),angular.module("core9Dashboard.admin.dashboard").requires.push("core9Dashboard.users"),angular.module("templates-module-platform-users",["users/edit.tpl.html"]),angular.module("users/edit.tpl.html",[]).run(["$templateCache",function(a){a.put("users/edit.tpl.html",'<h1 class="page-header">Edit image profile</h1>\n<div class="form-group row">\n  <label class="col-md-2 control-label">Name</label>\n  <div class="col-md-8">\n    <input type="text" ng-model="profile.name" class="form-control input-md" />\n  </div>\n</div>\n<div class="form-group row">\n  <label class="col-md-2 control-label">Width</label>\n  <div class="col-md-8">\n    <input type="number" ng-model="profile.width" class="form-control input-md" />\n  </div>\n</div>\n<div class="form-group row">\n  <label class="col-md-2 control-label">Height</label>\n  <div class="col-md-8">\n    <input type="number" ng-model="profile.height" class="form-control input-md" />\n  </div>\n</div>\n<fieldset>\n  <legend>Actions</legend>\n  <button class="btn btn-success" ng-click="save()">Save</button>\n</fieldset>')}]),angular.module("core9Dashboard.users.config",["ui.router"]).config(["$stateProvider",function(a){a.state("users",{url:"/config/users",views:{main:{controller:"UsersCtrl",templateUrl:"users/users.tpl.html"}},data:{pageTitle:"Users",context:"userscontext",sidebar:"config"}}).state("user",{url:"/config/user/:id",views:{main:{controller:"UsersEditCtrl",templateUrl:"users/edit.tpl.html"}},data:{pageTitle:"Edit user",context:"userscontext",sidebar:"config"},resolve:{profile:["ConfigFactory","$stateParams",function(a,b){return a.get({configtype:"imageprofile",id:b.id})}]}})}]).controller("UsersCtrl",["$scope","$http","$state","ConfigFactory",function(a,b,c,d){a.profiles=d.query({configtype:"imageprofile"}),a.edit=function(a){c.go("thumbnail",{id:a._id})},a.add=function(b){var c=new d;c.configtype="imageprofile",c.name=b,c.$save(),a.profiles.push(c)},a.remove=function(b,c){b.$remove(function(){a.profiles.splice(c,1)})},a.flush=function(){b.post("/admin/images/flush").success(function(){alert("Image caches flushed.")}).error(function(b){a.$emit("$error",b)})},a.flush=function(c){var d="";void 0!==c&&(d="/"+c.name),b.post("/admin/images/flush"+d).success(function(){alert("Image cache flushed.")}).error(function(b){a.$emit("$error",b)})},a.refresh=function(){b.post("/admin/images/refresh").success(function(){alert("Image profiles refreshed.")}).error(function(b){a.$emit("$error",b)})}}]).controller("UsersEditCtrl",["$scope","$state","profile",function(a,b,c){a.profile=c,a.save=function(){a.profile.$update(),b.go("thumbnails")}}]).run(["MenuService",function(a){a.add("config",{title:"Image profiles",weight:200,link:"thumbnails"}),a.add("thumbnailscontext",{title:"Refresh profiles",weight:0,link:"thumbnailsrefresh",template:'<a href="" ng-controller="ThumbnailsCtrl" ng-click="refresh()">Refresh profiles</a>'}),a.add("thumbnailscontext",{title:"Flush profiles",weight:0,link:"thumbnailsflush",template:'<a href="" ng-controller="ThumbnailsCtrl" ng-click="flush()">Flush profiles</a>'})}]);